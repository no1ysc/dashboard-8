# Document APIs
## Index API

elasticsearch에 document 추가
```
PUT sc_twitter/_doc/1
{
    "user" : "kimchy",
    "post_date" : "2009-11-15T14:12:12",
    "message" : "trying out Elasticsearch"
}
  
POST sc_twitter/_doc
{
    "user" : "kimchy",
    "post_date" : "2009-11-15T14:12:12",
    "message" : "trying out Elasticsearch"
}
```

## GET API
elasticsearch의 내용 확인
```
GET sc_twitter/_doc/1
  
GET sc_twitter/_doc/2
```
  
## DELETE API
elasticsearch의 document 삭제
```
DELETE sc_twitter/_doc/1
```
  
elasticsearch의 index 삭제
```
DELETE sc_twitter
```

## UPDATE API
시나리오1
```
# update api 시나리오1
PUT sc_twitter/_doc/1
{
    "user" : "kimchy",
    "post_date" : "2009-11-15T14:12:12",
    "message" : "trying out Elasticsearch"
}

# 결과1
GET sc_twitter/_doc/1

PUT sc_twitter/_doc/1
{
    "retweet" : 12
}

# 결과2
GET sc_twitter/_doc/1
```

시나리오2
```
#update api 시나리오2
PUT sc_twitter/_doc/1
{
    "user": "kimchy",
    "post_date": "2009-11-15T14:12:12",
    "message": "trying out Elasticsearch",
    "tags": ["red"]
}

GET sc_twitter/_doc/1

POST sc_twitter/_update/1
{
    "doc":
    {
      "category": "elastic"
    }
}

GET sc_twitter/_doc/1
```

시나리오3
```
#update api 시나리오3
PUT sc_twitter/_doc/1
{
  "user": "kimchy",
  "post_date": "2009-11-15T14:12:12",
  "message": "trying out Elasticsearch"
}

GET sc_twitter/_doc/1

POST sc_twitter/_update/1
{
  "script": {
    "source": "ctx._source.retweet = 12"
  }
}

GET sc_twitter/_doc/1
```

시나리오 4
```
#update api 시나리오4
GET sc_twitter/_doc/1

POST sc_twitter/_update/1
{
  "script": {
    "source": "ctx._source.retweet += params.count",
    "lang": "painless",
    "params": {
      "count": 4
    }
  }
}

GET sc_twitter/_doc/1
```

시나리오5
```
#update api 시나리오 5
PUT sc_twitter/_doc/1
{
  "user": "kimchy",
  "post_date": "2009-11-15T14:12:12",
  "message": "trying out Elasticsearch",
  "tags": [
    "red"
  ]
}

GET sc_twitter/_doc/1

POST sc_twitter/_update/1
{
  "script": {
    "source": "ctx._source.tags.add(params.tag)",
    "lang": "painless",
    "params": {
      "tag": "blue"
    }
  }
}

GET sc_twitter/_doc/1
```

시나리오6
```
#update api 시나리오6
PUT sc_twitter/_doc/1
{
  "user": "kimchy",
  "post_date": "2009-11-15T14:12:12",
  "message": "trying out Elasticsearch",
  "tags": [
    "red"
  ]
}

GET sc_twitter/_doc/1

POST sc_twitter/_update/1
{
  "script": "ctx._source.remove('tags')"
}

GET sc_twitter/_doc/1
```

시나리오7
```
#update api 시나리오7
PUT sc_twitter/_doc/1
{
  "user": "kimchy",
  "post_date": "2009-11-15T14:12:12",
  "message": "trying out Elasticsearch",
  "tags": [
    "red"
  ]
}

GET sc_twitter/_doc/1

POST sc_twitter/_update/1
{
  "script": {
    "source": "if (ctx._source.tags.contains(params.tag)) { ctx.op = 'delete' } else { ctx.op = 'none' }",
    "lang": "painless",
    "params": {
      "tag": "green"
    }
  }
}

GET sc_twitter/_doc/1
```

시나리오8
```
#update api 시나리오8
PUT sc_twitter/_doc/1
{
  "user": "kimchy",
  "post_date": "2009-11-15T14:12:12",
  "message": "trying out Elasticsearch",
  "tags": [
    "red"
  ]
}

GET sc_twitter/_doc/1

POST sc_twitter/_update/1
{
  "script": {
    "source": """
    if (ctx._source.tags.contains(params.tag)) {
      ctx.op = 'delete'
    } else {
      ctx.op = 'none'
    }""",
    "lang": "painless",
    "params": {
      "tag": "green"
    }
  }
}

GET sc_twitter/_doc/1
```

시나리오9
```
#update api 시나리오9
PUT sc_twitter/_doc/1
{
  "user": "kimchy",
  "post_date": "2009-11-15T14:12:12",
  "message": "trying out Elasticsearch",
  "tags": [
    "red"
  ]
}

GET sc_twitter/_doc/1

POST sc_twitter/_update/1
{
  "script": {
    "source": """
    if (ctx._source.tags.contains(params.tag)) {
      ctx.op = 'delete'
    } else {
      ctx.op = 'none'
    }""",
    "lang": "painless",
    "params": {
      "tag": "red"
    }
  }
}

GET sc_twitter/_doc/1
```

시나리오 10
```
#update api 시나리오 10
DELETE sc_twitter/_doc/1

GET sc_twitter/_doc/1

POST sc_twitter/_update/1
{
  "script": {
    "source": "ctx._source.counter += params.count",
    "lang": "painless",
    "params": {
      "count": 4
    }
  },
  "upsert": {
    "counter": 1
  }
}

GET sc_twitter/_doc/1

POST sc_twitter/_update/1
{
  "script": {
    "source": "ctx._source.counter += params.count",
    "lang": "painless",
    "params": {
      "count": 4
    }
  },
  "upsert": {
    "counter": 1
  }
}

GET sc_twitter/_doc/1
```

## termvector
```
PUT sc_twitter/_doc/1
{
  "user": "kimchy",
  "post_date": "2009-11-15T14:12:12",
  "message": "trying out Elasticsearch",
  "tags": [
    "red"
  ]
}

GET sc_twitter/_termvectors/1?fields=message
```

